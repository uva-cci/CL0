"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getUnregisteredClasses = getUnregisteredClasses;
// runner.js
const node_path_1 = require("node:path");
const node_process_1 = require("node:process");
const synckit_1 = require("synckit");
const version_js_1 = require("../utils/version.js");
const workerPath = getWorkerPath();
const version = (0, version_js_1.getTailwindcssVersion)();
const workerOptions = getWorkerOptions();
const getUnregisteredClassesSync = (0, synckit_1.createSyncFn)(workerPath, workerOptions);
function getUnregisteredClasses(request) {
    if (!(0, version_js_1.isSupportedVersion)(version.major)) {
        throw new Error(`Unsupported Tailwind CSS version: ${version.major}`);
    }
    return getUnregisteredClassesSync(version.major, request);
}
function getWorkerPath() {
    return (0, node_path_1.resolve)(getCurrentDirectory(), "./unregistered-classes.async.js");
}
function getWorkerOptions() {
    if (node_process_1.env.NODE_ENV === "test") {
        return { execArgv: ["--import", synckit_1.TsRunner.TSX] };
    }
}
function getCurrentDirectory() {
    // eslint-disable-next-line eslint-plugin-typescript/prefer-ts-expect-error
    // @ts-ignore - `import.meta` doesn't exist in CommonJS -> will be transformed in build step
    return __dirname;
}
//# sourceMappingURL=unregistered-classes.sync.js.map